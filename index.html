<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MotoApp Caucasia - GPS Real</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        body { margin: 0; display: flex; flex-direction: column; height: 100vh; font-family: 'Segoe UI', sans-serif; background: #f4f4f4; }
        #map { flex-grow: 1; width: 100%; }

        .container { 
            padding: 20px; 
            background: white; 
            border-radius: 25px 25px 0 0; 
            box-shadow: 0 -5px 15px rgba(0,0,0,0.15); 
            z-index: 1000;
        }

        h2 { margin: 0 0 10px 0; font-size: 1.4rem; text-align: center; }

        .input-group { margin-bottom: 10px; }

        input { 
            width: 100%; 
            padding: 14px; 
            margin: 6px 0; 
            border: 1px solid #eee; 
            border-radius: 12px; 
            font-size: 1rem;
            box-sizing: border-box;
            background: #f9f9f9;
        }

        .price-info { 
            text-align: center; 
            margin: 10px 0; 
            font-size: 1.1rem; 
        }

        .btn-request { 
            width: 100%; 
            padding: 18px; 
            background: #ffcc00; /* Amarillo taxi de tus capturas */
            border: none; 
            border-radius: 15px; 
            font-weight: bold; 
            font-size: 1.1rem;
            cursor: pointer;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

    <div id="map"></div>

    <div class="container">
        <h2>쮸 d칩nde vas hoy?</h2>
        
        <div class="input-group">
            <input type="text" id="origen" placeholder="游늸 Detectando tu ubicaci칩n..." readonly>
            <input type="text" id="destino" placeholder="游끠 Toca el mapa para el destino" readonly>
        </div>

        <div class="price-info">
            Tarifa estimada: <strong id="tarifa">$ 5.000</strong>
        </div>

        <button class="btn-request" onclick="solicitar()">SOLICITAR MOTOTAXI</button>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // 1. Iniciar mapa (Caucasia por defecto si falla el GPS)
        var map = L.map('map').setView([7.986, -75.193], 15);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '춸 OpenStreetMap'
        }).addTo(map);

        // Iconos personalizados
        var motoIcon = L.icon({
            iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png',
            iconSize: [25, 41], iconAnchor: [12, 41]
        });

        var destinoIcon = L.icon({
            iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
            iconSize: [25, 41], iconAnchor: [12, 41]
        });

        // 2. ACTIVAR GPS REAL
        map.locate({setView: true, maxZoom: 16});

        function onLocationFound(e) {
            L.marker(e.latlng).addTo(map).bindPopup("Est치s aqu칤").openPopup();
            document.getElementById('origen').value = "Mi ubicaci칩n detectada";
        }
        map.on('locationfound', onLocationFound);

        // 3. SELECCIONAR DESTINO TOCANDO EL MAPA
        var marcadorDestino;
        map.on('click', function(e) {
            if (marcadorDestino) map.removeLayer(marcadorDestino);
            
            marcadorDestino = L.marker(e.latlng, {icon: destinoIcon}).addTo(map);
            
            // Llenar el cuadro de destino con coordenadas
            document.getElementById('destino').value = "Destino: " + e.latlng.lat.toFixed(4) + ", " + e.latlng.lng.toFixed(4);
            
            // Cambiar precio simulado
            document.getElementById('tarifa').innerText = "$ 6.500";
        });

        // Simular una moto cerca
        L.marker([7.988, -75.192], {icon: motoIcon}).addTo(map).bindPopup("Mototaxista disponible");

        function solicitar() {
            const dest = document.getElementById('destino').value;
            if(!dest) {
                alert("Primero toca el mapa para decirnos a d칩nde vas.");
            } else {
                alert("Buscando al mototaxista m치s cercano...");
            }
        }
    </script>
</body>
</html>
